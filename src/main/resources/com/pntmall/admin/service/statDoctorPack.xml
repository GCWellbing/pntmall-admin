<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="StatMember">

	<select id="dailyList" parameterType="Param" resultType="Param">
		<![CDATA[
			SELECT DATE_FORMAT(STR_TO_DATE(D.YMD, '%Y%m%d'),'%Y-%m-%d') YMD
			     , IFNULL(RES_CNT, 0) RES_CNT, IFNULL(10_CNT, 0) 10_CNT, IFNULL(20_CNT, 0) 20_CNT, IFNULL(30_CNT, 0) 30_CNT, IFNULL(40_CNT, 0) 40_CNT, IFNULL(50_CNT, 0) 50_CNT, IFNULL(60_CNT, 0) 60_CNT, IFNULL(70_CNT, 0) 70_CNT, IFNULL(M_CNT, 0) M_CNT, IFNULL(F_CNT, 0) F_CNT
			     , IFNULL(COMPLETE_CNT, 0) COMPLETE_CNT, IFNULL(COMPLETE_10_CNT, 0) COMPLETE_10_CNT, IFNULL(COMPLETE_20_CNT, 0) COMPLETE_20_CNT, IFNULL(COMPLETE_30_CNT, 0) COMPLETE_30_CNT, IFNULL(COMPLETE_40_CNT, 0) COMPLETE_40_CNT, IFNULL(COMPLETE_50_CNT, 0) COMPLETE_50_CNT, IFNULL(COMPLETE_60_CNT, 0) COMPLETE_60_CNT, IFNULL(COMPLETE_70_CNT, 0) COMPLETE_70_CNT, IFNULL(COMPLETE_M_CNT, 0) COMPLETE_M_CNT, IFNULL(COMPLETE_F_CNT, 0) COMPLETE_F_CNT
			     , IFNULL(CANCEL_CNT, 0) CANCEL_CNT, IFNULL(CANCEL_10_CNT, 0) CANCEL_10_CNT, IFNULL(CANCEL_20_CNT, 0) CANCEL_20_CNT, IFNULL(CANCEL_30_CNT, 0) CANCEL_30_CNT, IFNULL(CANCEL_40_CNT, 0) CANCEL_40_CNT, IFNULL(CANCEL_50_CNT, 0) CANCEL_50_CNT, IFNULL(CANCEL_60_CNT, 0) CANCEL_60_CNT, IFNULL(CANCEL_70_CNT, 0) CANCEL_70_CNT, IFNULL(CANCEL_M_CNT, 0) CANCEL_M_CNT, IFNULL(CANCEL_F_CNT, 0) CANCEL_F_CNT
			     , IFNULL(CUS_CANCEL_CNT, 0) CUS_CANCEL_CNT, IFNULL(CUS_CANCEL_10_CNT, 0) CUS_CANCEL_10_CNT, IFNULL(CUS_CANCEL_20_CNT, 0) CUS_CANCEL_20_CNT, IFNULL(CUS_CANCEL_30_CNT, 0) CUS_CANCEL_30_CNT, IFNULL(CUS_CANCEL_40_CNT, 0) CUS_CANCEL_40_CNT, IFNULL(CUS_CANCEL_50_CNT, 0) CUS_CANCEL_50_CNT, IFNULL(CUS_CANCEL_60_CNT, 0) CUS_CANCEL_60_CNT, IFNULL(CUS_CANCEL_70_CNT, 0) CUS_CANCEL_70_CNT, IFNULL(CUS_CANCEL_M_CNT, 0) CUS_CANCEL_M_CNT, IFNULL(CUS_CANCEL_F_CNT, 0) CUS_CANCEL_F_CNT
			     , IFNULL(CLI_CANCEL_CNT, 0) CLI_CANCEL_CNT, IFNULL(CLI_CANCEL_10_CNT, 0) CLI_CANCEL_10_CNT, IFNULL(CLI_CANCEL_20_CNT, 0) CLI_CANCEL_20_CNT, IFNULL(CLI_CANCEL_30_CNT, 0) CLI_CANCEL_30_CNT, IFNULL(CLI_CANCEL_40_CNT, 0) CLI_CANCEL_40_CNT, IFNULL(CLI_CANCEL_50_CNT, 0) CLI_CANCEL_50_CNT, IFNULL(CLI_CANCEL_60_CNT, 0) CLI_CANCEL_60_CNT, IFNULL(CLI_CANCEL_70_CNT, 0) CLI_CANCEL_70_CNT, IFNULL(CLI_CANCEL_M_CNT, 0) CLI_CANCEL_M_CNT, IFNULL(CLI_CANCEL_F_CNT, 0) CLI_CANCEL_F_CNT
			FROM T_DATE D
					LEFT OUTER JOIN (
						SELECT DATE_FORMAT(R.CDATE,'%Y%m%d') YMD
						/* 예약건수 */
						     , COUNT(R.RES_NO) RES_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) <= '1' ,1,0)) 10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '2' ,1,0)) 20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '3' ,1,0)) 30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '4' ,1,0)) 40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '5' ,1,0)) 50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '6' ,1,0)) 60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) >= '7' ,1,0)) 70_CNT
							 , SUM(IF( GENDER = 'M' ,1,0)) M_CNT
							 , SUM(IF( GENDER = 'W' ,1,0)) F_CNT
						/* 완료건수 */
						     , SUM(IF( R.STATUS = '025005' ,1,0) ) COMPLETE_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) <= '1') && R.STATUS = '025005' ,1,0) ) COMPLETE_10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '2') && R.STATUS = '025005' ,1,0)) COMPLETE_20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '3') && R.STATUS = '025005' ,1,0)) COMPLETE_30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '4') && R.STATUS = '025005' ,1,0)) COMPLETE_40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '5') && R.STATUS = '025005' ,1,0)) COMPLETE_50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '6') && R.STATUS = '025005' ,1,0)) COMPLETE_60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) >= '7') && R.STATUS = '025005' ,1,0)) COMPLETE_70_CNT
							 , SUM(IF( GENDER = 'M' && R.STATUS = '025005' ,1,0)) COMPLETE_M_CNT
							 , SUM(IF( GENDER = 'W' && R.STATUS = '025005' ,1,0)) COMPLETE_F_CNT
						/* 취소건수 */
						     , SUM(IF( (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0) ) CANCEL_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) <= '1') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0) ) CANCEL_10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '2') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '3') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '4') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '5') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '6') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) >= '7') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_70_CNT
							 , SUM(IF( GENDER = 'M' && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_M_CNT
							 , SUM(IF( GENDER = 'W' && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_F_CNT
						/* 고객취소건수 */
							 , SUM(IF( (R.STATUS = '025002' || R.STATUS = '025006') ,1,0) ) CUS_CANCEL_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) <= '1') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0) ) CUS_CANCEL_10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '2') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '3') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '4') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '5') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '6') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) >= '7') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_70_CNT
							 , SUM(IF( GENDER = 'M' && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_M_CNT
							 , SUM(IF( GENDER = 'W' && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_F_CNT
						/* 병원취소건수 */
							 , SUM(IF( (R.STATUS = '025003') ,1,0) ) CLI_CANCEL_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) <= '1') && (R.STATUS = '025003') ,1,0) ) CLI_CANCEL_10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '2') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '3') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '4') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '5') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '6') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) >= '7') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_70_CNT
							 , SUM(IF( GENDER = 'M' && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_M_CNT
							 , SUM(IF( GENDER = 'W' && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_F_CNT
						  FROM T_RESERVATION R, T_MEMBER M
						 WHERE R.CUSER = M.MEM_NO
						   AND R.cate = '016005'
					       AND DATE_FORMAT(R.CDATE,'%Y%m%d') >= replace(#{sdate},'.','')
						   AND DATE_FORMAT(R.CDATE,'%Y%m%d') <= replace(#{edate},'.','')
						 GROUP BY DATE_FORMAT(R.CDATE,'%Y%m%d') ) R
			             ON D.YMD = R.YMD
		   WHERE D.YMD >= replace(#{sdate},'.','')
			 AND D.YMD <= replace(#{edate},'.','')
		   ORDER BY D.YMD
		]]>
	</select>

	<select id="weekList" parameterType="Param" resultType="Param">
		<![CDATA[
			SELECT CASE WEEKDAY WHEN '0' THEN '월요일'
							    WHEN '1' THEN '화요일'
							    WHEN '2' THEN '수요일'
							    WHEN '3' THEN '목요일'
							    WHEN '4' THEN '금요일'
							    WHEN '5' THEN '토요일'
							    WHEN '6' THEN '일요일'
							    END AS YMD
			     , IFNULL(RES_CNT, 0) RES_CNT, IFNULL(10_CNT, 0) 10_CNT, IFNULL(20_CNT, 0) 20_CNT, IFNULL(30_CNT, 0) 30_CNT, IFNULL(40_CNT, 0) 40_CNT, IFNULL(50_CNT, 0) 50_CNT, IFNULL(60_CNT, 0) 60_CNT, IFNULL(70_CNT, 0) 70_CNT, IFNULL(M_CNT, 0) M_CNT, IFNULL(F_CNT, 0) F_CNT
			     , IFNULL(CONFIRM_CNT, 0) CONFIRM_CNT, IFNULL(CONFIRM_10_CNT, 0) CONFIRM_10_CNT, IFNULL(CONFIRM_20_CNT, 0) CONFIRM_20_CNT, IFNULL(CONFIRM_30_CNT, 0) CONFIRM_30_CNT, IFNULL(CONFIRM_40_CNT, 0) CONFIRM_40_CNT, IFNULL(CONFIRM_50_CNT, 0) CONFIRM_50_CNT, IFNULL(CONFIRM_60_CNT, 0) CONFIRM_60_CNT, IFNULL(CONFIRM_70_CNT, 0) CONFIRM_70_CNT, IFNULL(CONFIRM_M_CNT, 0) CONFIRM_M_CNT, IFNULL(CONFIRM_F_CNT, 0) CONFIRM_F_CNT
			     , IFNULL(COMPLETE_CNT, 0) COMPLETE_CNT, IFNULL(COMPLETE_10_CNT, 0) COMPLETE_10_CNT, IFNULL(COMPLETE_20_CNT, 0) COMPLETE_20_CNT, IFNULL(COMPLETE_30_CNT, 0) COMPLETE_30_CNT, IFNULL(COMPLETE_40_CNT, 0) COMPLETE_40_CNT, IFNULL(COMPLETE_50_CNT, 0) COMPLETE_50_CNT, IFNULL(COMPLETE_60_CNT, 0) COMPLETE_60_CNT, IFNULL(COMPLETE_70_CNT, 0) COMPLETE_70_CNT, IFNULL(COMPLETE_M_CNT, 0) COMPLETE_M_CNT, IFNULL(COMPLETE_F_CNT, 0) COMPLETE_F_CNT
			     , IFNULL(CANCEL_CNT, 0) CANCEL_CNT, IFNULL(CANCEL_10_CNT, 0) CANCEL_10_CNT, IFNULL(CANCEL_20_CNT, 0) CANCEL_20_CNT, IFNULL(CANCEL_30_CNT, 0) CANCEL_30_CNT, IFNULL(CANCEL_40_CNT, 0) CANCEL_40_CNT, IFNULL(CANCEL_50_CNT, 0) CANCEL_50_CNT, IFNULL(CANCEL_60_CNT, 0) CANCEL_60_CNT, IFNULL(CANCEL_70_CNT, 0) CANCEL_70_CNT, IFNULL(CANCEL_M_CNT, 0) CANCEL_M_CNT, IFNULL(CANCEL_F_CNT, 0) CANCEL_F_CNT
			     , IFNULL(CUS_CANCEL_CNT, 0) CUS_CANCEL_CNT, IFNULL(CUS_CANCEL_10_CNT, 0) CUS_CANCEL_10_CNT, IFNULL(CUS_CANCEL_20_CNT, 0) CUS_CANCEL_20_CNT, IFNULL(CUS_CANCEL_30_CNT, 0) CUS_CANCEL_30_CNT, IFNULL(CUS_CANCEL_40_CNT, 0) CUS_CANCEL_40_CNT, IFNULL(CUS_CANCEL_50_CNT, 0) CUS_CANCEL_50_CNT, IFNULL(CUS_CANCEL_60_CNT, 0) CUS_CANCEL_60_CNT, IFNULL(CUS_CANCEL_70_CNT, 0) CUS_CANCEL_70_CNT, IFNULL(CUS_CANCEL_M_CNT, 0) CUS_CANCEL_M_CNT, IFNULL(CUS_CANCEL_F_CNT, 0) CUS_CANCEL_F_CNT
			     , IFNULL(CLI_CANCEL_CNT, 0) CLI_CANCEL_CNT, IFNULL(CLI_CANCEL_10_CNT, 0) CLI_CANCEL_10_CNT, IFNULL(CLI_CANCEL_20_CNT, 0) CLI_CANCEL_20_CNT, IFNULL(CLI_CANCEL_30_CNT, 0) CLI_CANCEL_30_CNT, IFNULL(CLI_CANCEL_40_CNT, 0) CLI_CANCEL_40_CNT, IFNULL(CLI_CANCEL_50_CNT, 0) CLI_CANCEL_50_CNT, IFNULL(CLI_CANCEL_60_CNT, 0) CLI_CANCEL_60_CNT, IFNULL(CLI_CANCEL_70_CNT, 0) CLI_CANCEL_70_CNT, IFNULL(CLI_CANCEL_M_CNT, 0) CLI_CANCEL_M_CNT, IFNULL(CLI_CANCEL_F_CNT, 0) CLI_CANCEL_F_CNT
			FROM (SELECT A.RNUM WEEKDAY
				    FROM (SELECT @ROWNUM:=@ROWNUM+1 RNUM
						    FROM T_DATE D,(SELECT @ROWNUM:=-1) TM ) A
				   WHERE A.RNUM < 7) D
					LEFT OUTER JOIN (
						SELECT WEEKDAY(R.CDATE) DAYOFWEEK
						/* 예약건수 */
						     , COUNT(R.RES_NO) RES_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) <= '1' ,1,0)) 10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '2' ,1,0)) 20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '3' ,1,0)) 30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '4' ,1,0)) 40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '5' ,1,0)) 50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '6' ,1,0)) 60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) >= '7' ,1,0)) 70_CNT
							 , SUM(IF( GENDER = 'M' ,1,0)) M_CNT
							 , SUM(IF( GENDER = 'W' ,1,0)) F_CNT
						/* 확정건수 */
						     , SUM(IF( R.STATUS = '025004' ,1,0) ) CONFIRM_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) <= '1') && R.STATUS = '025004' ,1,0) ) CONFIRM_10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '2') && R.STATUS = '025004' ,1,0)) CONFIRM_20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '3') && R.STATUS = '025004' ,1,0)) CONFIRM_30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '4') && R.STATUS = '025004' ,1,0)) CONFIRM_40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '5') && R.STATUS = '025004' ,1,0)) CONFIRM_50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '6') && R.STATUS = '025004' ,1,0)) CONFIRM_60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) >= '7') && R.STATUS = '025004' ,1,0)) CONFIRM_70_CNT
							 , SUM(IF( GENDER = 'M' && R.STATUS = '025004' ,1,0)) CONFIRM_M_CNT
							 , SUM(IF( GENDER = 'W' && R.STATUS = '025004' ,1,0)) CONFIRM_F_CNT
						/* 완료건수 */
						     , SUM(IF( R.STATUS = '025005' ,1,0) ) COMPLETE_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) <= '1') && R.STATUS = '025005' ,1,0) ) COMPLETE_10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '2') && R.STATUS = '025005' ,1,0)) COMPLETE_20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '3') && R.STATUS = '025005' ,1,0)) COMPLETE_30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '4') && R.STATUS = '025005' ,1,0)) COMPLETE_40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '5') && R.STATUS = '025005' ,1,0)) COMPLETE_50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '6') && R.STATUS = '025005' ,1,0)) COMPLETE_60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) >= '7') && R.STATUS = '025005' ,1,0)) COMPLETE_70_CNT
							 , SUM(IF( GENDER = 'M' && R.STATUS = '025005' ,1,0)) COMPLETE_M_CNT
							 , SUM(IF( GENDER = 'W' && R.STATUS = '025005' ,1,0)) COMPLETE_F_CNT
						/* 취소건수 */
						     , SUM(IF( (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0) ) CANCEL_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) <= '1') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0) ) CANCEL_10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '2') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '3') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '4') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '5') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '6') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) >= '7') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_70_CNT
							 , SUM(IF( GENDER = 'M' && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_M_CNT
							 , SUM(IF( GENDER = 'W' && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_F_CNT
						/* 고객취소건수 */
							 , SUM(IF( (R.STATUS = '025002' || R.STATUS = '025006') ,1,0) ) CUS_CANCEL_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) <= '1') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0) ) CUS_CANCEL_10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '2') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '3') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '4') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '5') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '6') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) >= '7') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_70_CNT
							 , SUM(IF( GENDER = 'M' && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_M_CNT
							 , SUM(IF( GENDER = 'W' && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_F_CNT
						/* 병원취소건수 */
							 , SUM(IF( (R.STATUS = '025003') ,1,0) ) CLI_CANCEL_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) <= '1') && (R.STATUS = '025003') ,1,0) ) CLI_CANCEL_10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '2') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '3') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '4') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '5') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '6') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) >= '7') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_70_CNT
							 , SUM(IF( GENDER = 'M' && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_M_CNT
							 , SUM(IF( GENDER = 'W' && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_F_CNT
						  FROM T_RESERVATION R, T_MEMBER M
						 WHERE R.CUSER = M.MEM_NO
						   AND R.cate = '016005'
					       AND DATE_FORMAT(R.CDATE,'%Y%m%d') >= replace(#{sdate},'.','')
						   AND DATE_FORMAT(R.CDATE,'%Y%m%d') <= replace(#{edate},'.','')
						 GROUP BY WEEKDAY(R.CDATE) ) R
		             ON D.WEEKDAY = R.DAYOFWEEK
		   ORDER BY D.WEEKDAY
		]]>
	</select>

	<select id="timeList" parameterType="Param" resultType="Param">
		<![CDATA[
			SELECT D.HH YMD
			     , IFNULL(RES_CNT, 0) RES_CNT, IFNULL(10_CNT, 0) 10_CNT, IFNULL(20_CNT, 0) 20_CNT, IFNULL(30_CNT, 0) 30_CNT, IFNULL(40_CNT, 0) 40_CNT, IFNULL(50_CNT, 0) 50_CNT, IFNULL(60_CNT, 0) 60_CNT, IFNULL(70_CNT, 0) 70_CNT, IFNULL(M_CNT, 0) M_CNT, IFNULL(F_CNT, 0) F_CNT
			     , IFNULL(COMPLETE_CNT, 0) COMPLETE_CNT, IFNULL(COMPLETE_10_CNT, 0) COMPLETE_10_CNT, IFNULL(COMPLETE_20_CNT, 0) COMPLETE_20_CNT, IFNULL(COMPLETE_30_CNT, 0) COMPLETE_30_CNT, IFNULL(COMPLETE_40_CNT, 0) COMPLETE_40_CNT, IFNULL(COMPLETE_50_CNT, 0) COMPLETE_50_CNT, IFNULL(COMPLETE_60_CNT, 0) COMPLETE_60_CNT, IFNULL(COMPLETE_70_CNT, 0) COMPLETE_70_CNT, IFNULL(COMPLETE_M_CNT, 0) COMPLETE_M_CNT, IFNULL(COMPLETE_F_CNT, 0) COMPLETE_F_CNT
			     , IFNULL(CANCEL_CNT, 0) CANCEL_CNT, IFNULL(CANCEL_10_CNT, 0) CANCEL_10_CNT, IFNULL(CANCEL_20_CNT, 0) CANCEL_20_CNT, IFNULL(CANCEL_30_CNT, 0) CANCEL_30_CNT, IFNULL(CANCEL_40_CNT, 0) CANCEL_40_CNT, IFNULL(CANCEL_50_CNT, 0) CANCEL_50_CNT, IFNULL(CANCEL_60_CNT, 0) CANCEL_60_CNT, IFNULL(CANCEL_70_CNT, 0) CANCEL_70_CNT, IFNULL(CANCEL_M_CNT, 0) CANCEL_M_CNT, IFNULL(CANCEL_F_CNT, 0) CANCEL_F_CNT
			     , IFNULL(CUS_CANCEL_CNT, 0) CUS_CANCEL_CNT, IFNULL(CUS_CANCEL_10_CNT, 0) CUS_CANCEL_10_CNT, IFNULL(CUS_CANCEL_20_CNT, 0) CUS_CANCEL_20_CNT, IFNULL(CUS_CANCEL_30_CNT, 0) CUS_CANCEL_30_CNT, IFNULL(CUS_CANCEL_40_CNT, 0) CUS_CANCEL_40_CNT, IFNULL(CUS_CANCEL_50_CNT, 0) CUS_CANCEL_50_CNT, IFNULL(CUS_CANCEL_60_CNT, 0) CUS_CANCEL_60_CNT, IFNULL(CUS_CANCEL_70_CNT, 0) CUS_CANCEL_70_CNT, IFNULL(CUS_CANCEL_M_CNT, 0) CUS_CANCEL_M_CNT, IFNULL(CUS_CANCEL_F_CNT, 0) CUS_CANCEL_F_CNT
			     , IFNULL(CLI_CANCEL_CNT, 0) CLI_CANCEL_CNT, IFNULL(CLI_CANCEL_10_CNT, 0) CLI_CANCEL_10_CNT, IFNULL(CLI_CANCEL_20_CNT, 0) CLI_CANCEL_20_CNT, IFNULL(CLI_CANCEL_30_CNT, 0) CLI_CANCEL_30_CNT, IFNULL(CLI_CANCEL_40_CNT, 0) CLI_CANCEL_40_CNT, IFNULL(CLI_CANCEL_50_CNT, 0) CLI_CANCEL_50_CNT, IFNULL(CLI_CANCEL_60_CNT, 0) CLI_CANCEL_60_CNT, IFNULL(CLI_CANCEL_70_CNT, 0) CLI_CANCEL_70_CNT, IFNULL(CLI_CANCEL_M_CNT, 0) CLI_CANCEL_M_CNT, IFNULL(CLI_CANCEL_F_CNT, 0) CLI_CANCEL_F_CNT
			FROM (SELECT concat(LPAD(A.RNUM,'2','0'),':00') HH
				    FROM (SELECT @ROWNUM:=@ROWNUM+1 RNUM
						    FROM T_DATE D,(SELECT @ROWNUM:=-1) TM ) A
				   WHERE A.RNUM < 25) D
					LEFT OUTER JOIN (
						SELECT DATE_FORMAT(R.CDATE,'%H:00') HH
						/* 예약건수 */
						     , COUNT(R.RES_NO) RES_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) <= '1' ,1,0)) 10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '2' ,1,0)) 20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '3' ,1,0)) 30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '4' ,1,0)) 40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '5' ,1,0)) 50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '6' ,1,0)) 60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) >= '7' ,1,0)) 70_CNT
							 , SUM(IF( GENDER = 'M' ,1,0)) M_CNT
							 , SUM(IF( GENDER = 'W' ,1,0)) F_CNT
						/* 완료건수 */
						     , SUM(IF( R.STATUS = '025005' ,1,0) ) COMPLETE_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) <= '1') && R.STATUS = '025005' ,1,0) ) COMPLETE_10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '2') && R.STATUS = '025005' ,1,0)) COMPLETE_20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '3') && R.STATUS = '025005' ,1,0)) COMPLETE_30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '4') && R.STATUS = '025005' ,1,0)) COMPLETE_40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '5') && R.STATUS = '025005' ,1,0)) COMPLETE_50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '6') && R.STATUS = '025005' ,1,0)) COMPLETE_60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) >= '7') && R.STATUS = '025005' ,1,0)) COMPLETE_70_CNT
							 , SUM(IF( GENDER = 'M' && R.STATUS = '025005' ,1,0)) COMPLETE_M_CNT
							 , SUM(IF( GENDER = 'W' && R.STATUS = '025005' ,1,0)) COMPLETE_F_CNT
						/* 취소건수 */
						     , SUM(IF( (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0) ) CANCEL_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) <= '1') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0) ) CANCEL_10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '2') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '3') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '4') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '5') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '6') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) >= '7') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_70_CNT
							 , SUM(IF( GENDER = 'M' && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_M_CNT
							 , SUM(IF( GENDER = 'W' && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_F_CNT
						/* 고객취소건수 */
							 , SUM(IF( (R.STATUS = '025002' || R.STATUS = '025006') ,1,0) ) CUS_CANCEL_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) <= '1') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0) ) CUS_CANCEL_10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '2') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '3') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '4') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '5') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '6') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) >= '7') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_70_CNT
							 , SUM(IF( GENDER = 'M' && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_M_CNT
							 , SUM(IF( GENDER = 'W' && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_F_CNT
						/* 병원취소건수 */
							 , SUM(IF( (R.STATUS = '025003') ,1,0) ) CLI_CANCEL_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) <= '1') && (R.STATUS = '025003') ,1,0) ) CLI_CANCEL_10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '2') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '3') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '4') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '5') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '6') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) >= '7') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_70_CNT
							 , SUM(IF( GENDER = 'M' && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_M_CNT
							 , SUM(IF( GENDER = 'W' && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_F_CNT
						  FROM T_RESERVATION R, T_MEMBER M
						 WHERE R.CUSER = M.MEM_NO
						   AND R.cate = '016005'
					       AND DATE_FORMAT(R.CDATE,'%Y%m%d') >= replace(#{sdate},'.','')
						   AND DATE_FORMAT(R.CDATE,'%Y%m%d') <= replace(#{edate},'.','')
						 GROUP BY DATE_FORMAT(R.CDATE,'%H:00') ) R
			             ON D.HH = R.HH
		   ORDER BY D.HH
		]]>
	</select>

	<select id="monthList" parameterType="Param" resultType="Param">
		<![CDATA[
			SELECT DATE_FORMAT(STR_TO_DATE(D.YM, '%Y%m'),'%Y-%m') YMD
			     , IFNULL(RES_CNT, 0) RES_CNT, IFNULL(10_CNT, 0) 10_CNT, IFNULL(20_CNT, 0) 20_CNT, IFNULL(30_CNT, 0) 30_CNT, IFNULL(40_CNT, 0) 40_CNT, IFNULL(50_CNT, 0) 50_CNT, IFNULL(60_CNT, 0) 60_CNT, IFNULL(70_CNT, 0) 70_CNT, IFNULL(M_CNT, 0) M_CNT, IFNULL(F_CNT, 0) F_CNT
			     , IFNULL(COMPLETE_CNT, 0) COMPLETE_CNT, IFNULL(COMPLETE_10_CNT, 0) COMPLETE_10_CNT, IFNULL(COMPLETE_20_CNT, 0) COMPLETE_20_CNT, IFNULL(COMPLETE_30_CNT, 0) COMPLETE_30_CNT, IFNULL(COMPLETE_40_CNT, 0) COMPLETE_40_CNT, IFNULL(COMPLETE_50_CNT, 0) COMPLETE_50_CNT, IFNULL(COMPLETE_60_CNT, 0) COMPLETE_60_CNT, IFNULL(COMPLETE_70_CNT, 0) COMPLETE_70_CNT, IFNULL(COMPLETE_M_CNT, 0) COMPLETE_M_CNT, IFNULL(COMPLETE_F_CNT, 0) COMPLETE_F_CNT
			     , IFNULL(CANCEL_CNT, 0) CANCEL_CNT, IFNULL(CANCEL_10_CNT, 0) CANCEL_10_CNT, IFNULL(CANCEL_20_CNT, 0) CANCEL_20_CNT, IFNULL(CANCEL_30_CNT, 0) CANCEL_30_CNT, IFNULL(CANCEL_40_CNT, 0) CANCEL_40_CNT, IFNULL(CANCEL_50_CNT, 0) CANCEL_50_CNT, IFNULL(CANCEL_60_CNT, 0) CANCEL_60_CNT, IFNULL(CANCEL_70_CNT, 0) CANCEL_70_CNT, IFNULL(CANCEL_M_CNT, 0) CANCEL_M_CNT, IFNULL(CANCEL_F_CNT, 0) CANCEL_F_CNT
			     , IFNULL(CUS_CANCEL_CNT, 0) CUS_CANCEL_CNT, IFNULL(CUS_CANCEL_10_CNT, 0) CUS_CANCEL_10_CNT, IFNULL(CUS_CANCEL_20_CNT, 0) CUS_CANCEL_20_CNT, IFNULL(CUS_CANCEL_30_CNT, 0) CUS_CANCEL_30_CNT, IFNULL(CUS_CANCEL_40_CNT, 0) CUS_CANCEL_40_CNT, IFNULL(CUS_CANCEL_50_CNT, 0) CUS_CANCEL_50_CNT, IFNULL(CUS_CANCEL_60_CNT, 0) CUS_CANCEL_60_CNT, IFNULL(CUS_CANCEL_70_CNT, 0) CUS_CANCEL_70_CNT, IFNULL(CUS_CANCEL_M_CNT, 0) CUS_CANCEL_M_CNT, IFNULL(CUS_CANCEL_F_CNT, 0) CUS_CANCEL_F_CNT
			     , IFNULL(CLI_CANCEL_CNT, 0) CLI_CANCEL_CNT, IFNULL(CLI_CANCEL_10_CNT, 0) CLI_CANCEL_10_CNT, IFNULL(CLI_CANCEL_20_CNT, 0) CLI_CANCEL_20_CNT, IFNULL(CLI_CANCEL_30_CNT, 0) CLI_CANCEL_30_CNT, IFNULL(CLI_CANCEL_40_CNT, 0) CLI_CANCEL_40_CNT, IFNULL(CLI_CANCEL_50_CNT, 0) CLI_CANCEL_50_CNT, IFNULL(CLI_CANCEL_60_CNT, 0) CLI_CANCEL_60_CNT, IFNULL(CLI_CANCEL_70_CNT, 0) CLI_CANCEL_70_CNT, IFNULL(CLI_CANCEL_M_CNT, 0) CLI_CANCEL_M_CNT, IFNULL(CLI_CANCEL_F_CNT, 0) CLI_CANCEL_F_CNT
			FROM (SELECT DATE_FORMAT(YMD,'%Y%m') YM from T_DATE GROUP BY YM) D
					LEFT OUTER JOIN (
						SELECT DATE_FORMAT(R.CDATE,'%Y%m') YM
						/* 예약건수 */
						     , COUNT(R.RES_NO) RES_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) <= '1' ,1,0)) 10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '2' ,1,0)) 20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '3' ,1,0)) 30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '4' ,1,0)) 40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '5' ,1,0)) 50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) = '6' ,1,0)) 60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1)) >= '7' ,1,0)) 70_CNT
							 , SUM(IF( GENDER = 'M' ,1,0)) M_CNT
							 , SUM(IF( GENDER = 'W' ,1,0)) F_CNT
						/* 완료건수 */
						     , SUM(IF( R.STATUS = '025005' ,1,0) ) COMPLETE_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) <= '1') && R.STATUS = '025005' ,1,0) ) COMPLETE_10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '2') && R.STATUS = '025005' ,1,0)) COMPLETE_20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '3') && R.STATUS = '025005' ,1,0)) COMPLETE_30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '4') && R.STATUS = '025005' ,1,0)) COMPLETE_40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '5') && R.STATUS = '025005' ,1,0)) COMPLETE_50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '6') && R.STATUS = '025005' ,1,0)) COMPLETE_60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) >= '7') && R.STATUS = '025005' ,1,0)) COMPLETE_70_CNT
							 , SUM(IF( GENDER = 'M' && R.STATUS = '025005' ,1,0)) COMPLETE_M_CNT
							 , SUM(IF( GENDER = 'W' && R.STATUS = '025005' ,1,0)) COMPLETE_F_CNT
						/* 취소건수 */
						     , SUM(IF( (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0) ) CANCEL_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) <= '1') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0) ) CANCEL_10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '2') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '3') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '4') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '5') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '6') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) >= '7') && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_70_CNT
							 , SUM(IF( GENDER = 'M' && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_M_CNT
							 , SUM(IF( GENDER = 'W' && (R.STATUS = '025002' || R.STATUS = '025003' || R.STATUS = '025006') ,1,0)) CANCEL_F_CNT
						/* 고객취소건수 */
							 , SUM(IF( (R.STATUS = '025002' || R.STATUS = '025006') ,1,0) ) CUS_CANCEL_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) <= '1') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0) ) CUS_CANCEL_10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '2') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '3') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '4') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '5') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '6') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) >= '7') && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_70_CNT
							 , SUM(IF( GENDER = 'M' && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_M_CNT
							 , SUM(IF( GENDER = 'W' && (R.STATUS = '025002' || R.STATUS = '025006') ,1,0)) CUS_CANCEL_F_CNT
						/* 병원취소건수 */
							 , SUM(IF( (R.STATUS = '025003') ,1,0) ) CLI_CANCEL_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) <= '1') && (R.STATUS = '025003') ,1,0) ) CLI_CANCEL_10_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '2') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_20_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '3') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_30_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '4') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_40_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '5') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_50_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) = '6') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_60_CNT
							 , SUM(IF( (SUBSTR(DATE_FORMAT(NOW(),'%Y') - SUBSTR(BIRTHDAY,1,4)+1,1,1) >= '7') && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_70_CNT
							 , SUM(IF( GENDER = 'M' && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_M_CNT
							 , SUM(IF( GENDER = 'W' && (R.STATUS = '025003') ,1,0)) CLI_CANCEL_F_CNT
						  FROM T_RESERVATION R, T_MEMBER M
						 WHERE R.CUSER = M.MEM_NO
						   AND R.cate = '016005'
					       AND DATE_FORMAT(R.CDATE,'%Y%m%d') >= replace(#{sdate},'.','')
						   AND DATE_FORMAT(R.CDATE,'%Y%m%d') <= replace(#{edate},'.','')
						 GROUP BY DATE_FORMAT(R.CDATE,'%Y%m') ) R
			             ON D.YM = R.YM
		   WHERE D.YM >= DATE_FORMAT(STR_TO_DATE(#{sdate}, '%Y.%m.%d'),'%Y%m')
			 AND D.YM <= DATE_FORMAT(STR_TO_DATE(#{edate}, '%Y.%m.%d'),'%Y%m')
		   ORDER BY D.YM
		]]>
	</select>


</mapper>